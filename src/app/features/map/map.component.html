<section class="map-page">
  <header class="page-header">
    <div>
      <p class="eyebrow">Interactive Coverage</p>
      <h1>Regional Allocation Map</h1>
      <p class="helper">Dive deeper into state-level performance and allocation trends.</p>
    </div>
    <div class="header-actions">
      <a class="ghost" routerLink="/dashboard">Back to Dashboard</a>
      <button type="button" class="primary">Download Snapshot</button>
    </div>
  </header>

  <section class="map-layout">
    <aside class="state-panel">
      <p class="section-label">Priority Regions</p>
      <ul>
        @for (state of mapStates; track state.id) {
          <li>
            <button type="button" class="state-row" [class.active]="isActive(state)" (click)="selectState(state)">
              <span class="dot" [style.background]="state.color"></span>
              <div class="state-copy">
                <strong>{{ state.label }}</strong>
                <p>{{ state.stands }} stands Â· {{ state.delta }}</p>
              </div>
              <span class="state-percent">{{ state.percent }}</span>
            </button>
          </li>
        }
      </ul>

      <div class="insights">
        @for (insight of keyInsights; track insight.label) {
          <article>
            <p class="eyebrow">{{ insight.label }}</p>
            <strong>{{ insight.value }}</strong>
            <p class="helper">{{ insight.helper }}</p>
          </article>
        }
      </div>
    </aside>

    <div class="map-canvas">
      <figure>
        <svg viewBox="0 0 800 450" class="map-svg" preserveAspectRatio="xMidYMid meet">
          <path class="map-outline" [attr.d]="mapOutlinePath"></path>
          @for (state of mapStates; track state.id) {
            <path class="map-state" [attr.d]="state.path" [style.fill]="state.color" [class.active]="isActive(state)"></path>
            <circle
              class="state-marker"
              [attr.cx]="state.centroid.x"
              [attr.cy]="state.centroid.y"
              r="6"
              [style.fill]="state.color"
            ></circle>
          }
        </svg>
      </figure>

      <div class="state-detail">
        <p class="eyebrow">Selected Region</p>
        <h2>{{ activeState.label }}</h2>
        <p class="helper">Detailed performance insight for {{ activeState.label }}.</p>

        <div class="detail-grid">
          <article>
            <span class="label">Allocation</span>
            <strong>{{ activeState.percent }}</strong>
            <p>{{ activeState.stands }} stands deployed</p>
          </article>
          <article>
            <span class="label">Trajectory</span>
            <strong>{{ activeState.delta }}</strong>
            <p>month-over-month shift</p>
          </article>
        </div>

        <footer>
          <p class="eyebrow">Snapshot metrics</p>
          <div class="summary-row">
            @for (metric of mapSummaryStats; track metric.label) {
              <div>
                <span>{{ metric.label }}</span>
                <strong>{{ metric.value }}</strong>
              </div>
            }
          </div>
        </footer>
      </div>
    </div>
  </section>
</section>

